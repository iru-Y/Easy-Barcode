"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.plugin = plugin;
const webpack_1 = require("@dotenv-run/webpack");
const index_html_serve_1 = require("./index-html-serve");
function plugin(options, ssr = false) {
    const dotEnvPlugin = new webpack_1.DotenvRunPlugin({ ...options, environment: process.env.NODE_ENV, nodeEnv: false }, ssr);
    const raw = dotEnvPlugin.raw;
    return {
        raw,
        webpackConfiguration: (webpackConfig) => {
            webpackConfig.plugins.push(dotEnvPlugin);
            return webpackConfig;
        },
        indexHtml: async (content) => {
            return (0, index_html_serve_1.indexHtml)(content, raw, options.runtime);
        },
    };
}
//# sourceMappingURL=webpack-plugin.js.map